<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script type="text/javascript" src="//api.map.baidu.com/api?type=webgl&v=1.0&ak=2Cj12hK8X1jz5STDaOUrGShTmyaw5aUB"></script>
    <style>
        #container {
            width: 100%;
            height: 500px;
            border: 1px solid saddlebrown;
        }
    </style>
</head>

<body>
    <button onclick="setMapTypeChange(BMAP_NORMAL_MAP)">普通街道视图</button>
    <button onclick="setMapTypeChange(BMAP_EARTH_MAP)">地球卫星视图</button>
    <div id="container"></div>

    <script>
        const map = new BMapGL.Map('container');

        var point = new BMapGL.Point(116.418261, 39.921984);
        map.centerAndZoom(point, 15);
        map.enableScrollWheelZoom()
        map.setTilt(50);  // 设置倾斜角度

        // 行政边界
        (function getBoundary() {
            const bdary = new BMapGL.Boundary()
            bdary.get('湖南凤凰', (rs) => {
                const count = rs.boundaries.length
                if (count === 0) return
                let pointArr = []
                let polygonArr = []
                let prismArr = []
                for (let i = 0; i < count; i++) {
                    // GL版本必须传Point数组
                    const arr = rs.boundaries[i].split(';').map(p => {
                        const [lng, lat] = p.split(', ')
                        const point = new BMapGL.Point(lng, lat)
                        return point
                    });
                    pointArr = pointArr.concat(arr)

                    // 建立棱柱 卫星图中没有效果
                    const prism = new BMapGL.Prism(arr, 5000, // 必须返回BMapGL.Point[]
                        {
                            topFillColor: '#5679ea',
                            topFillOpacity: 0.5,
                            sideFillColor: '#5679ea',
                            sideFillOpacity: 0.9
                            // enableMassClear: true // 是否再调用前清除本身
                        });

                    // 多边形覆盖物
                    const ply = new BMapGL.Polygon(rs.boundaries[i], // 返回的不是BMap.Point[] 也能画, 返回的是 105.11,31.5;106.5,23.5... 字符串
                        {
                            strokeWeight: 2,
                            strokeStyle: 'dashed',
                            strokeColor: "#ff0000",
                            strokeOpacity: 0.6,
                            fillColor: 'pink'
                        });

                    polygonArr = polygonArr.concat(ply)
                    prismArr = prismArr.concat(prism)
                }
                [...polygonArr, ...prismArr].map(o => map.addOverlay(o)) // 添加覆盖物
                map.setViewport(pointArr);    // 调整视野
            })
        })()

        // 改变地图类型
        const setMapTypeChange = (type) => map.setMapType(type)

    </script>
</body>

</html>